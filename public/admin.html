<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Panel - Active Users</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: linear-gradient(135deg, #2e2e2e, #1c1c1c);
      color: #f0f0f0;
      min-height: 100vh;
      overflow: hidden;
      padding: 40px 80px;
    }

    .starflakes {
      pointer-events: none;
      position: fixed;
      inset: 0;
      overflow: hidden;
      z-index: 0;
    }
    .starflake {
      position: absolute;
      top: -10px;
      width: 4px;
      height: 4px;
      background: linear-gradient(45deg, #ff7a29, #ffaa44);
      border-radius: 50%;
      opacity: 0.9;
      filter: drop-shadow(0 0 6px #ff7a29);
      animation-name: fall;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
      animation-fill-mode: forwards;
    }
    .starflake:nth-child(1) { left: 10%; animation-duration: 8s; animation-delay: 0s; width: 3px; height: 3px; opacity: 0.6; }
    .starflake:nth-child(2) { left: 20%; animation-duration: 12s; animation-delay: 3s; }
    .starflake:nth-child(3) { left: 35%; animation-duration: 10s; animation-delay: 1s; width: 3px; height: 3px; opacity: 0.7; }
    .starflake:nth-child(4) { left: 50%; animation-duration: 15s; animation-delay: 5s; width: 5px; height: 5px; opacity: 0.9; }
    .starflake:nth-child(5) { left: 65%; animation-duration: 11s; animation-delay: 2s; opacity: 0.8; }
    .starflake:nth-child(6) { left: 80%; animation-duration: 9s; animation-delay: 4s; width: 3px; height: 3px; opacity: 0.5; }
    .starflake:nth-child(7) { left: 90%; animation-duration: 13s; animation-delay: 1s; opacity: 0.7; }

    @keyframes fall {
      0% {
        top: -10px;
        transform: translateX(0) rotate(0deg);
        opacity: 0.9;
      }
      100% {
        top: 110vh;
        transform: translateX(40px) rotate(360deg);
        opacity: 0;
      }
    }

    header {
      background-color: #222;
      padding: 20px 80px;
      box-shadow: 0 2px 10px rgba(255, 122, 41, 0.3);
      color: #ff7a29;
      font-size: 1.8rem;
      font-weight: 700;
      position: relative;
      z-index: 1;
      margin-bottom: 40px;
      border-radius: 12px;
    }

    main {
      max-width: 1400px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    h1 {
      margin-bottom: 24px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #333;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(255, 122, 41, 0.6);
    }
    th, td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #ff7a29;
      font-size: 1rem;
    }
    th {
      background: #ff7a2944;
    }
    tr:last-child td {
      border-bottom: none;
    }
  </style>
</head>
<body>
  <div class="starflakes" aria-hidden="true">
    <div class="starflake"></div>
    <div class="starflake"></div>
    <div class="starflake"></div>
    <div class="starflake"></div>
    <div class="starflake"></div>
    <div class="starflake"></div>
    <div class="starflake"></div>
  </div>

  <header>CoreAPI Admin Panel</header>

  <main>
    <h1>Active Users</h1>
    <table id="activeUsersTable" aria-live="polite" role="table">
      <thead>
        <tr>
          <th>User ID</th>
          <th>Username</th>
          <th>Last Activity</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="3">Loading active users...</td></tr>
      </tbody>
    </table>
  </main>

  <script>
    async function fetchActiveUsers() {
      try {
        const response = await fetch('/api/active-users'); // Your API endpoint
        if (!response.ok) throw new Error('Failed to fetch active users');
        const users = await response.json();

        const tbody = document.querySelector('#activeUsersTable tbody');
        if(!users.length) {
          tbody.innerHTML = '<tr><td colspan="3">No active users found.</td></tr>';
          return;
        }
        tbody.innerHTML = users.map(u => `
          <tr>
            <td>${u.id}</td>
            <td>${u.username}</td>
            <td>${u.lastActivity}</td>
          </tr>
        `).join('');
      } catch (e) {
        console.error(e);
        const tbody = document.querySelector('#activeUsersTable tbody');
        tbody.innerHTML = '<tr><td colspan="3">Failed to load active users.</td></tr>';
      }
    }

    fetchActiveUsers();
    setInterval(fetchActiveUsers, 30000); // refresh every 30 seconds
  </script>
</body>
</html>
